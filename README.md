# db_mai_course


### 1. Индексы в PostgreSQL

**Что такое индекс?**
Индекс — это специальная структура в базе данных, которая ускоряет поиск строк по значениям в столбцах. По сути, это как оглавление в книге: не надо листать все страницы, чтобы найти нужную.

**Основные типы:**

* **B-tree** — самый популярный. Хорош для точного поиска, сортировки и диапазонных запросов (`WHERE price > 100`).
* **GIN** (Generalized Inverted Index) — нужен, если ты ищешь что-то внутри массивов или по множеству слов (например, в полнотекстовом поиске).
* **BRIN** (Block Range INdexes) — для очень больших таблиц, где данные отсортированы (например, по дате). Такой индекс хранит только диапазоны значений.

**Для чего?**
Индексы экономят время при поиске, но требуют места на диске и иногда замедляют вставку новых данных (ведь индекс тоже надо обновлять).

---

### 2. Транзакции

**Что такое транзакция?**
Транзакция — это группа SQL-команд, которые должны выполниться все вместе или не выполниться вообще. Пример: перевод денег между счетами. Если при переводе что-то пойдёт не так, нужно откатить всё, чтобы не было путаницы.

**Уровни изоляции** (важно для параллельной работы с БД):

* **Read Uncommitted** — можно читать даже "грязные" (несохранённые) данные. В PostgreSQL не поддерживается.
* **Read Committed** — по умолчанию. Ты видишь только подтверждённые изменения.
* **Repeatable Read** — данные в транзакции не меняются, даже если другие транзакции что-то обновили.
* **Serializable** — максимальная защита, транзакции как бы выполняются по очереди.

**Аномалии:**

* **Dirty Read** — ты видишь незавершённые изменения другой транзакции.
* **Non-repeatable Read** — данные изменились после твоего первого чтения.
* **Phantom Read** — добавились новые строки, которых не было при первом чтении.

---

### 3. Расширения

**pg\_bigm и pg\_trgm**

* `pg_bigm` — ускоряет поиск по большим словам (2-символьные биграммы).
* `pg_trgm` — ищет похожие слова (по триграммам — кусочкам по 3 символа).

**pgcrypto**
Позволяет хранить данные (например, пароли) в зашифрованном виде прямо в базе. Это нужно для безопасности.

